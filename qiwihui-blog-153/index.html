<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> SVG NFT 全面实践 ── scaffold-eth loogies-svg-nft 项目完整指南 · QIWIHUI</title><meta name="description" content="SVG NFT 全面实践 ── scaffold-eth loogies-svg-nft 项目完整指南 - qiwihui"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/nella.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.12/css/all.css" integrity="sha384-G0fIWCsCzJIMAVNQPfjH08cyYaUtMwjJwqiRKxxE/rx96Uroj1BtIQ6MLJuheaO9" crossorigin="anonymous"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
google_ad_client: "ca-pub-8935595858652656",
enable_page_level_ads: true
});
</script><link rel="search" type="application/opensearchdescription+xml" href="https://qiwihui.com/atom.xml" title="QIWIHUI"><meta property="og:site_name" content="QIWIHUI"><meta property="og:url" content="https://qiwihui.com/qiwihui-blog-153/index.html"><meta property="og:title" content="SVG NFT 全面实践 ── scaffold-eth loogies-svg-nft 项目完整指南"><meta property="og:description" content="SVG NFT 全面实践 ── scaffold-eth loogies-svg-nft 项目完整指南"><meta property="og:type" content="article"><script src="//code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script><meta name="generator" content="Hexo 4.2.1"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/images/avatar.jpg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/search/" target="_self" class="nav-list-link">SEARCH</a></li><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">HOME</a></li><li class="nav-list-item"><a href="/projects/" target="_self" class="nav-list-link">PROJECTS</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">TAGS</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li><li class="nav-list-item"><a href="/links/" target="_self" class="nav-list-link">LINKS</a></li><!--li.nav-list-item--><!--    a.nav-list-link(class="search" href=url_for("search") target="_self") SEARCH--></ul></header><main class="container"></main><div class="post"><article class="post-block"><h1 class="post-title">SVG NFT 全面实践 ── scaffold-eth loogies-svg-nft 项目完整指南</h1><div class="post-info">May 15, 2024<span class="categories"><i class="fa fa-bookmark" aria-hidden="true"></i></span><a href="/categories/%E6%8A%80%E6%9C%AF/" class="post-category">#技术</a><span>30 min. read</span></div><div class="post-content"><p>注：这篇文章是我投稿于“李大狗Leeduckgo”公众号的文章，原文地址：<a href="https://mp.weixin.qq.com/s/WvTFk3E6FjfHtXfp2uHkrw" target="_blank" rel="noopener">SVG NFT 全面实践 | Web3.0 dApp 开发（六）</a>。</p>
<hr>
<p>loogies-svg-nft 是 scaffold-eth 提供的一个简单的 NFT 铸造和展示的项目，在本教程中，我们将带领大家一步步分析和实现这个项目。</p>
<p>由于项目的 <code>loogies-svg-nft</code> 分支与 <code>master</code> 分支在组件库和主页上有一些变化，故先将 <code>master</code> 分支代码与 <code>loogies-svg-nft</code> 分支进行了合并，解决冲突，得到一份基新组件库的全新的代码。可以参考项目地址： <a href="https://github.com/qiwihui/scaffold-eth.git" target="_blank" rel="noopener">https://github.com/qiwihui/scaffold-eth.git</a> 的 <code>loogies-svg-nft</code> 分支。本文以下内容将基于这些代码进行部署和分析。</p>
<a id="more"></a>
<h2><span id="ben-di-yun-xing-he-ce-shi">本地运行和测试</span></h2>
<p>首先我们先运行项目查看我们将要分析实现的功能。</p>
<h3><span id="ben-di-yun-xing">本地运行</span></h3>
<p>首先我们在本地运行项目：</p>
<p>clone 项目并切换到 <code>loogies-svg-nft</code> 分支：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/qiwihui/scaffold-eth.git loogies-svg-nft</span><br><span class="line"><span class="built_in">cd</span> loogies-svg-nft</span><br><span class="line">git checkout loogies-svg-nft</span><br></pre></td></tr></table></figure>
<p>安装依赖包</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn install</span><br></pre></td></tr></table></figure>
<p>运行前端</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn start</span><br></pre></td></tr></table></figure>
<p>在第二个终端窗口中，运行本地测试链</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn chain</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/3297411/153822009-3154003e-6433-4a29-a511-b33b5f37a99a.png" alt="yarn-chain"></p>
<p>在第三个终端窗口中，运行部署合约</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn deploy</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/3297411/153822065-4c4a0ffa-95e3-4e16-8272-ace2f102625b.png" alt="yarn-deploy"></p>
<p>此时在浏览器中访问 <a href="http://localhost:3000/" target="_blank" rel="noopener"><code>http://localhost:3000</code></a> ，就可以看到程序了。</p>
<p><img src="https://user-images.githubusercontent.com/3297411/153822123-f6f7e3b0-ac6e-4625-a0bd-9bc4170d6aeb.png" alt="yarn-start"></p>
<h3><span id="ben-di-ce-shi">本地测试</span></h3>
<ol>
<li>
<p>首先在 MetaMask 钱包中添加本地网络，并切换到本地网络；</p>
<ul>
<li>网络名称： <code>Localhost 8545</code></li>
<li>新增 RPC URL： <code>http://localhost:8545</code></li>
<li>链 ID： <code>31337</code></li>
<li>Currency Symbol： <code>ETH</code></li>
</ul>
</li>
<li>
<p>创建一个新的本地钱包账号；</p>
</li>
<li>
<p>复制钱包地址，在页面左下角给这个地址发送一些测试 ETH；</p>
</li>
<li>
<p>点击在页面右上角 <code>connect</code> 连接钱包；</p>
</li>
<li>
<p>点击 Mint 铸造；</p>
</li>
<li>
<p>当交易成功后，可以看到新铸造的 NFT；</p>
<p><img src="https://user-images.githubusercontent.com/3297411/153822198-6442f4d1-fa49-43e1-bb7c-eacc1b1d082d.png" alt="nft-display"></p>
</li>
</ol>
<p>下面，我们开始对项目合约进行分析。</p>
<h2><span id="loogies-he-yue-fen-xi">Loogies 合约分析</span></h2>
<h3><span id="nft-yu-erc721">NFT 与 ERC721</span></h3>
<p><strong>NFT</strong>，全称为Non-Fungible Token，指非同质化代币，对应于以太坊上 ERC-721 标准。 一般在智能合约中，NFT 的定义包含 <code>tokenId</code> 和 <code>tokenURI</code> ，每一个 NFT 的 <code>tokenId</code> 是唯一的， <code>tokenURI</code> 对于保存了NFT的元数据，可以是图像URL、描述、属性等。如果一个 NFT 想在 NFT 市场上进行展示和销售，则 <code>tokenURI</code> 内容需要对应符合 NFT 市场的标准，比如，在 NFT 市场 OpenSea <a href="https://docs.opensea.io/docs/metadata-standards" target="_blank" rel="noopener">元数据标准</a>中，就指出了 NFT 展示需要设置的属性。</p>
<p><img src="https://user-images.githubusercontent.com/3297411/153822292-ac9fa169-199b-49cb-b8bd-4ec3e680842c.png" alt="OpenSea 中 NFT 元数据与展示对应关系"></p>
<p>OpenSea 中 NFT 元数据与展示对应关系</p>
<h3><span id="he-yue-gai-lan">合约概览</span></h3>
<p><a href="https://github.com/scaffold-eth/scaffold-eth/tree/loogies-svg-nft" target="_blank" rel="noopener">loogies-svg-nft 项目</a>的合约文件在 <code>packages/hardhat/contracts/</code> 路径下，包含以下三个文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">packages/hardhat/contracts/</span><br><span class="line">├── HexStrings.sol</span><br><span class="line">├── ToColor.sol</span><br><span class="line">└── YourCollectible.sol</span><br></pre></td></tr></table></figure>
<ul>
<li><code>HexString.sol</code> ：生成地址字符串；</li>
<li><code>ToColor.sol</code>：生成颜色编码字符串；</li>
<li><code>YourCollectible.sol</code>： <code>Loogies</code> NFT的合约文件，主要功能涉及合约铸造和元数据生成。</li>
</ul>
<p>合约的主要结构和方法为：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">contract YourCollectible is ERC721, Ownable &#123;</span><br><span class="line"></span><br><span class="line">	// 构造函数</span><br><span class="line">  constructor() public ERC721(&quot;Loogies&quot;, &quot;LOOG&quot;) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  // 铸造 NFT</span><br><span class="line">  function mintItem()</span><br><span class="line">      public</span><br><span class="line">      returns (uint256)</span><br><span class="line">  &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">	// 获取 tokenId 对应 tokeURI</span><br><span class="line">  function tokenURI(uint256 id) public view override returns (string memory) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">	// 生成 tokenId 对应 svg 代码</span><br><span class="line">  function generateSVGofTokenById(uint256 id) internal view returns (string memory) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">	// 生成 tokenId 对应 svg 代码，主要用于绘制图像</span><br><span class="line">  function renderTokenById(uint256 id) public view returns (string memory) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="gou-zao-han-shu">构造函数</span></h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">constructor() public ERC721(&quot;Loogies&quot;, &quot;LOOG&quot;) &#123;</span><br><span class="line">    // RELEASE THE LOOGIES!</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>代币符号： <code>Loogies</code></p>
<p>代币名称： <code>LOOG</code></p>
<p>合约继承自 OpenZeppelin 的 <code>ERC721.sol</code>，这是 OpenZeppelin 提供的基本合约代码，可以方便开发者使用。</p>
<h3><span id="ying-yong-ku-han-shu">应用库函数</span></h3>
<p>合约中分别对 <code>uint256</code>， <code>uint160</code> 和 <code>bytes3</code> 等应用了不同库函数，扩展对应功能：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// 使 uint256 具有 toHexString 功能</span><br><span class="line">using Strings for uint256;</span><br><span class="line">// 使 uint160 具有自定义 toHexString 功能</span><br><span class="line">using HexStrings for uint160;</span><br><span class="line">// 使 bytes3 可以方便生成前端颜色表示</span><br><span class="line">using ToColor for bytes3;</span><br><span class="line">// 计数功能</span><br><span class="line">using Counters for Counters.Counter;</span><br></pre></td></tr></table></figure>
<h3><span id="mint-qi-xian">Mint 期限</span></h3>
<p>以下代码是 Mint 时间限制：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">uint256 mintDeadline = block.timestamp + 24 hours;</span><br><span class="line"></span><br><span class="line">function mintItem()</span><br><span class="line">      public</span><br><span class="line">      returns (uint256)</span><br><span class="line">  &#123;</span><br><span class="line">      require( block.timestamp &lt; mintDeadline, &quot;DONE MINTING&quot;);</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>合约在部署之后的24小时内可以铸造，超过24小时则会引发异常。这个机制类似于预售，由于这个合约比较简单，所以没有使用白名单机制，一般在实际情况，会使用预售和白名单的方式来控制 NFT 的发行。</p>
<h3><span id="mint-zhu-zao">Mint 铸造</span></h3>
<p>铸造 NFT 其实就是在合约中设置两个信息：</p>
<ul>
<li><code>tokenId</code> 及其 <code>owner</code></li>
<li><code>tokenId</code> 及其 <code>tokenURI</code></li>
</ul>
<p>我们首先看铸造函数 <code>mintItem</code>：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// 用于保存每一个铸造的 Loogies 的特征，其中，color 表示颜色，chubbiness 表示胖瘦</span><br><span class="line">mapping (uint256 =&gt; bytes3) public color;</span><br><span class="line">mapping (uint256 =&gt; uint256) public chubbiness;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">function mintItem()</span><br><span class="line">      public</span><br><span class="line">      returns (uint256)</span><br><span class="line">  &#123;</span><br><span class="line">      require( block.timestamp &lt; mintDeadline, &quot;DONE MINTING&quot;);</span><br><span class="line">			// 每次铸造前自增 _tokenIds，确保 _tokenIds 唯一</span><br><span class="line">      _tokenIds.increment();</span><br><span class="line"></span><br><span class="line">      uint256 id = _tokenIds.current();</span><br><span class="line">			// 铸造者与 tokenId 绑定</span><br><span class="line">      _mint(msg.sender, id);</span><br><span class="line">			// 随机生成对应 tokenId 的属性</span><br><span class="line">      bytes32 predictableRandom = keccak256(abi.encodePacked( blockhash(block.number-1), msg.sender, address(this), id ));</span><br><span class="line">      color[id] = bytes2(predictableRandom[0]) | ( bytes2(predictableRandom[1]) &gt;&gt; 8 ) | ( bytes3(predictableRandom[2]) &gt;&gt; 16 );</span><br><span class="line">      chubbiness[id] = 35+((55*uint256(uint8(predictableRandom[3])))/255);</span><br><span class="line"></span><br><span class="line">      return id;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>其中：</p>
<ul>
<li><code>tokenId</code> 在每次铸造时会自增，确保 <code>tokenId</code> 唯一；</li>
<li><code>_mint</code> 函数绑定 <code>tokenId</code> 及其 <code>owner</code>；</li>
<li>每一个 <code>tokenId</code> 对应的属性通过随机方式生成，具体为：
<ul>
<li>通过前一个区块的哈希（ <code>blockhash(block.number-1)</code> ），当前铸造账户（ <code>msg.sender</code>），合约地址（ <code>address(this)</code> ）和 <code>tokenId</code> 生成哈希 <code>predictableRandom</code>；</li>
<li>计算 NFT 颜色：按位或 <code>predictableRandom</code> 前三位得到颜色，颜色表示用 bytes3 表示，其中 <code>bytes2(predictableRandom[0])</code> 对应最低位蓝色数值， <code>( bytes2(predictableRandom[1]) &gt;&gt; 8 )</code>对应中间位绿色数值， <code>( bytes3(predictableRandom[2]) &gt;&gt; 16 )</code> 对应最高位红色数值；</li>
<li>计算 NFT 胖瘦： <code>35+((55*uint256(uint8(predictableRandom[3])))/255);</code> ，<code>uint8(predictableRandom[3])</code>介于0~255，故最小值为35，最大值为 35+55 = 90；</li>
</ul>
</li>
</ul>
<p>例如： <code>color</code> 为 <code>0x4cc4c1</code> ， <code>chubbiness</code> 为 88 时对应的 NFT 图片为：</p>
<p><img src="https://user-images.githubusercontent.com/3297411/153822433-3a1a41a4-f846-45f9-b74e-f699ccba6a81.png" alt="loogies-1"></p>
<h3><span id="tokenuri-han-shu">tokenURI 函数</span></h3>
<p>函数 <code>tokenURI</code> 接受 <code>tokenId</code> 参数，返回编码之后的元数据字符串：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function tokenURI(uint256 id) public view override returns (string memory) &#123;</span><br><span class="line">			// 检查 id 是否存在</span><br><span class="line">      require(_exists(id), &quot;not exist&quot;);</span><br><span class="line">      string memory name = string(abi.encodePacked(&apos;Loogie #&apos;,id.toString()));</span><br><span class="line">      string memory description = string(abi.encodePacked(&apos;This Loogie is the color #&apos;,color[id].toColor(),&apos; with a chubbiness of &apos;,uint2str(chubbiness[id]),&apos;!!!&apos;));</span><br><span class="line">      // 生成图片的svg base64 编码</span><br><span class="line">			string memory image = Base64.encode(bytes(generateSVGofTokenById(id)));</span><br><span class="line"></span><br><span class="line">      return</span><br><span class="line">          string(</span><br><span class="line">              abi.encodePacked(</span><br><span class="line">                &apos;data:application/json;base64,&apos;,</span><br><span class="line">								// 通过 base64 编码元数据</span><br><span class="line">                Base64.encode(</span><br><span class="line">                    bytes(</span><br><span class="line">                          abi.encodePacked(</span><br><span class="line">                              &apos;&#123;&quot;name&quot;:&quot;&apos;,</span><br><span class="line">                              name,</span><br><span class="line">                              &apos;&quot;, &quot;description&quot;:&quot;&apos;,</span><br><span class="line">                              description,</span><br><span class="line">                              &apos;&quot;, &quot;external_url&quot;:&quot;https://burnyboys.com/token/&apos;,</span><br><span class="line">                              id.toString(),</span><br><span class="line">                              &apos;&quot;, &quot;attributes&quot;: [&#123;&quot;trait_type&quot;: &quot;color&quot;, &quot;value&quot;: &quot;#&apos;,</span><br><span class="line">                              color[id].toColor(),</span><br><span class="line">                              &apos;&quot;&#125;,&#123;&quot;trait_type&quot;: &quot;chubbiness&quot;, &quot;value&quot;: &apos;,</span><br><span class="line">                              uint2str(chubbiness[id]),</span><br><span class="line">                              &apos;&#125;], &quot;owner&quot;:&quot;&apos;,</span><br><span class="line">                              (uint160(ownerOf(id))).toHexString(20),</span><br><span class="line">                              &apos;&quot;, &quot;image&quot;: &quot;&apos;,</span><br><span class="line">                              &apos;data:image/svg+xml;base64,&apos;,</span><br><span class="line">                              image,</span><br><span class="line">                              &apos;&quot;&#125;&apos;</span><br><span class="line">                          )</span><br><span class="line">                        )</span><br><span class="line">                    )</span><br><span class="line">              )</span><br><span class="line">          );</span><br><span class="line">  &#125;</span><br><span class="line">// 生成的 SVG 字符串</span><br><span class="line">function generateSVGofTokenById(uint256 id) internal view returns (string memory) &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 绘制图像</span><br><span class="line">// Visibility is `public` to enable it being called by other contracts for composition.</span><br><span class="line">function renderTokenById(uint256 id) public view returns (string memory) &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中， <code>generateSVGofTokenById</code> 函数返回 <code>tokenId</code> 对应的颜色和胖瘦属性生成的 SVG 字符串， <code>renderTokenById</code> 用户绘制图像。</p>
<p>我们可以看到，NFT 元数据中包含的属性有：</p>
<ul>
<li>name：名称</li>
<li>description： 描述</li>
<li>external_url：外部链接</li>
<li>attributes：属性
<ul>
<li>color 颜色</li>
<li>chubbiness：胖瘦</li>
<li>owner：所有者，以太坊地址16进制形式</li>
<li>image：图片对应 SVG 的 base64 编码</li>
</ul>
</li>
</ul>
<p>这里，我们通过实际数据了解一下什么是 SVG。<code>tokenId</code> 为 1 时对应的 <code>tokenURI</code> 结果为：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">data:application/json;base64,eyJuYW1lIjoiTG9vZ2llICMxIiwiZGVzY3JpcHRpb24iOiJUaGlzIExvb2dpZSBpcyB0aGUgY29sb3IgIzRjYzRjMSB3aXRoIGEgY2h1YmJpbmVzcyBvZiA4OCEhISIsImV4dGVybmFsX3VybCI6Imh0dHBzOi8vYnVybnlib3lzLmNvbS90b2tlbi8xIiwiYXR0cmlidXRlcyI6W3sidHJhaXRfdHlwZSI6ImNvbG9yIiwidmFsdWUiOiIjNGNjNGMxIn0seyJ0cmFpdF90eXBlIjoiY2h1YmJpbmVzcyIsInZhbHVlIjo4OH1dLCJvd25lciI6IjB4MTY5ODQxYWEzMDI0Y2ZhNTcwMDI0ZWI3ZGQ2YmY1Zjc3NDA5MjA4OCIsImltYWdlIjoiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTkRBd0lpQm9aV2xuYUhROUlqUXdNQ0lnZUcxc2JuTTlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5Mekl3TURBdmMzWm5JajQ4WnlCcFpEMGlaWGxsTVNJK1BHVnNiR2x3YzJVZ2MzUnliMnRsTFhkcFpIUm9QU0l6SWlCeWVUMGlNamt1TlNJZ2NuZzlJakk1TGpVaUlHbGtQU0p6ZG1kZk1TSWdZM2s5SWpFMU5DNDFJaUJqZUQwaU1UZ3hMalVpSUhOMGNtOXJaVDBpSXpBd01DSWdabWxzYkQwaUkyWm1aaUl2UGp4bGJHeHBjSE5sSUhKNVBTSXpMalVpSUhKNFBTSXlMalVpSUdsa1BTSnpkbWRmTXlJZ1kzazlJakUxTkM0MUlpQmplRDBpTVRjekxqVWlJSE4wY205clpTMTNhV1IwYUQwaU15SWdjM1J5YjJ0bFBTSWpNREF3SWlCbWFXeHNQU0lqTURBd01EQXdJaTgrUEM5blBqeG5JR2xrUFNKb1pXRmtJajQ4Wld4c2FYQnpaU0JtYVd4c1BTSWpOR05qTkdNeElpQnpkSEp2YTJVdGQybGtkR2c5SWpNaUlHTjRQU0l5TURRdU5TSWdZM2s5SWpJeE1TNDRNREEyTlNJZ2FXUTlJbk4yWjE4MUlpQnllRDBpT0RnaUlISjVQU0kxTVM0NE1EQTJOU0lnYzNSeWIydGxQU0lqTURBd0lpOCtQQzluUGp4bklHbGtQU0psZVdVeUlqNDhaV3hzYVhCelpTQnpkSEp2YTJVdGQybGtkR2c5SWpNaUlISjVQU0l5T1M0MUlpQnllRDBpTWprdU5TSWdhV1E5SW5OMloxOHlJaUJqZVQwaU1UWTRMalVpSUdONFBTSXlNRGt1TlNJZ2MzUnliMnRsUFNJak1EQXdJaUJtYVd4c1BTSWpabVptSWk4K1BHVnNiR2x3YzJVZ2NuazlJak11TlNJZ2NuZzlJak1pSUdsa1BTSnpkbWRmTkNJZ1kzazlJakUyT1M0MUlpQmplRDBpTWpBNElpQnpkSEp2YTJVdGQybGtkR2c5SWpNaUlHWnBiR3c5SWlNd01EQXdNREFpSUhOMGNtOXJaVDBpSXpBd01DSXZQand2Wno0OEwzTjJaejQ9In0=</span><br></pre></td></tr></table></figure>
<p>通过 base64 解码 <code>data:application/json;base64,</code> 之后的字符串可以得到如下 json（以下 json 经过了格式化，方便阅读）：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"Loogie #1"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">"This Loogie is the color #4cc4c1 with a chubbiness of 88!!!"</span>,</span><br><span class="line">  <span class="attr">"external_url"</span>: <span class="string">"https://burnyboys.com/token/1"</span>,</span><br><span class="line">  <span class="attr">"attributes"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"trait_type"</span>: <span class="string">"color"</span>,</span><br><span class="line">      <span class="attr">"value"</span>: <span class="string">"#4cc4c1"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"trait_type"</span>: <span class="string">"chubbiness"</span>,</span><br><span class="line">      <span class="attr">"value"</span>: <span class="number">88</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"owner"</span>: <span class="string">"0x169841aa3024cfa570024eb7dd6bf5f774092088"</span>,</span><br><span class="line">  <span class="attr">"image"</span>: <span class="string">"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBpZD0iZXllMSI+PGVsbGlwc2Ugc3Ryb2tlLXdpZHRoPSIzIiByeT0iMjkuNSIgcng9IjI5LjUiIGlkPSJzdmdfMSIgY3k9IjE1NC41IiBjeD0iMTgxLjUiIHN0cm9rZT0iIzAwMCIgZmlsbD0iI2ZmZiIvPjxlbGxpcHNlIHJ5PSIzLjUiIHJ4PSIyLjUiIGlkPSJzdmdfMyIgY3k9IjE1NC41IiBjeD0iMTczLjUiIHN0cm9rZS13aWR0aD0iMyIgc3Ryb2tlPSIjMDAwIiBmaWxsPSIjMDAwMDAwIi8+PC9nPjxnIGlkPSJoZWFkIj48ZWxsaXBzZSBmaWxsPSIjNGNjNGMxIiBzdHJva2Utd2lkdGg9IjMiIGN4PSIyMDQuNSIgY3k9IjIxMS44MDA2NSIgaWQ9InN2Z181IiByeD0iODgiIHJ5PSI1MS44MDA2NSIgc3Ryb2tlPSIjMDAwIi8+PC9nPjxnIGlkPSJleWUyIj48ZWxsaXBzZSBzdHJva2Utd2lkdGg9IjMiIHJ5PSIyOS41IiByeD0iMjkuNSIgaWQ9InN2Z18yIiBjeT0iMTY4LjUiIGN4PSIyMDkuNSIgc3Ryb2tlPSIjMDAwIiBmaWxsPSIjZmZmIi8+PGVsbGlwc2Ugcnk9IjMuNSIgcng9IjMiIGlkPSJzdmdfNCIgY3k9IjE2OS41IiBjeD0iMjA4IiBzdHJva2Utd2lkdGg9IjMiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMCIvPjwvZz48L3N2Zz4="</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们对 <code>image</code> 字段进行解码并格式化就得到图片的 SVG：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">width</span>=<span class="string">"400"</span> <span class="attr">height</span>=<span class="string">"400"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">g</span> <span class="attr">id</span>=<span class="string">"eye1"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ellipse</span> <span class="attr">stroke-width</span>=<span class="string">"3"</span> <span class="attr">ry</span>=<span class="string">"29.5"</span> <span class="attr">rx</span>=<span class="string">"29.5"</span> <span class="attr">id</span>=<span class="string">"svg_1"</span> <span class="attr">cy</span>=<span class="string">"154.5"</span> <span class="attr">cx</span>=<span class="string">"181.5"</span> <span class="attr">stroke</span>=<span class="string">"#000"</span> <span class="attr">fill</span>=<span class="string">"#fff"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ellipse</span> <span class="attr">ry</span>=<span class="string">"3.5"</span> <span class="attr">rx</span>=<span class="string">"2.5"</span> <span class="attr">id</span>=<span class="string">"svg_3"</span> <span class="attr">cy</span>=<span class="string">"154.5"</span> <span class="attr">cx</span>=<span class="string">"173.5"</span> <span class="attr">stroke-width</span>=<span class="string">"3"</span> <span class="attr">stroke</span>=<span class="string">"#000"</span> <span class="attr">fill</span>=<span class="string">"#000000"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">g</span> <span class="attr">id</span>=<span class="string">"head"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ellipse</span> <span class="attr">fill</span>=<span class="string">"#4cc4c1"</span> <span class="attr">stroke-width</span>=<span class="string">"3"</span> <span class="attr">cx</span>=<span class="string">"204.5"</span> <span class="attr">cy</span>=<span class="string">"211.80065"</span> <span class="attr">id</span>=<span class="string">"svg_5"</span> <span class="attr">rx</span>=<span class="string">"88"</span> <span class="attr">ry</span>=<span class="string">"51.80065"</span> <span class="attr">stroke</span>=<span class="string">"#000"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">g</span> <span class="attr">id</span>=<span class="string">"eye2"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ellipse</span> <span class="attr">stroke-width</span>=<span class="string">"3"</span> <span class="attr">ry</span>=<span class="string">"29.5"</span> <span class="attr">rx</span>=<span class="string">"29.5"</span> <span class="attr">id</span>=<span class="string">"svg_2"</span> <span class="attr">cy</span>=<span class="string">"168.5"</span> <span class="attr">cx</span>=<span class="string">"209.5"</span> <span class="attr">stroke</span>=<span class="string">"#000"</span> <span class="attr">fill</span>=<span class="string">"#fff"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ellipse</span> <span class="attr">ry</span>=<span class="string">"3.5"</span> <span class="attr">rx</span>=<span class="string">"3"</span> <span class="attr">id</span>=<span class="string">"svg_4"</span> <span class="attr">cy</span>=<span class="string">"169.5"</span> <span class="attr">cx</span>=<span class="string">"208"</span> <span class="attr">stroke-width</span>=<span class="string">"3"</span> <span class="attr">fill</span>=<span class="string">"#000000"</span> <span class="attr">stroke</span>=<span class="string">"#000"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>SVG是一种用 XML 定义的语言，用来描述二维矢量及矢量/栅格图形。它可以任意放大图形显示，也不会牺牲图像质量，它可以使用代码进行描述，方便编辑，因此被广泛使用。</p>
<p>从上面的代码结合以下的图像可以看出，这个 SVG 包含如下内容：</p>
<ul>
<li>第一行为 XML 声明，标明版本和编码类型，之后是SVG 的宽度和高度；</li>
<li><code>eye1</code>：由两个椭圆（ellipse）绘制的眼圈和黑色眼珠；</li>
<li><code>head</code>：填充 <code>#4cc4c1</code> 颜色的椭圆作为身体；</li>
<li><code>eye2</code>：与 <code>eye1</code> 一致，位置不同；</li>
</ul>
<p><code>eye1</code>，<code>head</code>和<code>eye2</code>依次叠加得到最终的图形：</p>
<p><img src="https://user-images.githubusercontent.com/3297411/153822497-6cdd7677-9594-4e78-8bc1-8f1b4c1158b8.png" alt="loogies-1"></p>
<h3><span id="fu-zhu-han-shu-jie-xi">辅助函数解析</span></h3>
<ol>
<li><code>uint2str</code> 将 <code>uint</code> 转变为字符串，例如 <code>123</code> 变为 <code>'123'</code></li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function uint2str(uint _i) internal pure returns (string memory _uintAsString) &#123;</span><br><span class="line">      if (_i == 0) &#123;</span><br><span class="line">          return &quot;0&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">      uint j = _i;</span><br><span class="line">			// uint 位数</span><br><span class="line">      uint len;</span><br><span class="line">      while (j != 0) &#123;</span><br><span class="line">          len++;</span><br><span class="line">          j /= 10;</span><br><span class="line">      &#125;</span><br><span class="line">      bytes memory bstr = new bytes(len);</span><br><span class="line">      uint k = len;</span><br><span class="line">      while (_i != 0) &#123;</span><br><span class="line">          k = k-1;</span><br><span class="line">			    // _i 个位数字</span><br><span class="line">          uint8 temp = (48 + uint8(_i - _i / 10 * 10));</span><br><span class="line">          bytes1 b1 = bytes1(temp);</span><br><span class="line">          bstr[k] = b1;</span><br><span class="line">          _i /= 10;</span><br><span class="line">      &#125;</span><br><span class="line">      return string(bstr);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<ol>
<li><code>ToColor.sol</code> 库：将 <code>byte3</code> 类型转换为前端颜色字符串，例如：输入 <code>0x4cc4c1</code> 输出 <code>'4cc4c1'</code></li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">library ToColor &#123;</span><br><span class="line">    bytes16 internal constant ALPHABET = &apos;0123456789abcdef&apos;;</span><br><span class="line"></span><br><span class="line">    function toColor(bytes3 value) internal pure returns (string memory) &#123;</span><br><span class="line">      bytes memory buffer = new bytes(6);</span><br><span class="line">      for (uint256 i = 0; i &lt; 3; i++) &#123;</span><br><span class="line">          buffer[i*2+1] = ALPHABET[uint8(value[i]) &amp; 0xf];</span><br><span class="line">          buffer[i*2] = ALPHABET[uint8(value[i]&gt;&gt;4) &amp; 0xf];</span><br><span class="line">      &#125;</span><br><span class="line">      return string(buffer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li><code>HexStrings.sol</code> 库：主要作用是将 <code>uint</code> 按 <code>length</code> 位提取，对应于生成公钥时截取前20位的功能： <code>(*uint160*(ownerOf(id))).toHexString(20)</code>，此表达式生成对应 <code>tokenId</code> 所有者的地址。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">library HexStrings &#123;</span><br><span class="line">    bytes16 internal constant ALPHABET = &apos;0123456789abcdef&apos;;</span><br><span class="line"></span><br><span class="line">    function toHexString(uint256 value, uint256 length) internal pure returns (string memory) &#123;</span><br><span class="line">        bytes memory buffer = new bytes(2 * length + 2);</span><br><span class="line">        buffer[0] = &apos;0&apos;;</span><br><span class="line">        buffer[1] = &apos;x&apos;;</span><br><span class="line">        for (uint256 i = 2 * length + 1; i &gt; 1; --i) &#123;</span><br><span class="line">            buffer[i] = ALPHABET[value &amp; 0xf];</span><br><span class="line">            value &gt;&gt;= 4;</span><br><span class="line">        &#125;</span><br><span class="line">        return string(buffer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>至此，合约源码分析完成。</p>
<p>下面我们将对前端的逻辑进行简要分析，然后我们将一步步实现 NFT 铸造和展示的功能。将代码切换到前端代码提交之前，按照以下的步骤一步步添加功能。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout a98156f6a03a0bc8fc98c8c77cef6fbf59f03b31</span><br></pre></td></tr></table></figure>
<h2><span id="qian-duan-luo-ji-fen-xi">前端逻辑分析</span></h2>
<p>项目前端文件在 <code>packages/react-app</code> 内，以下文章中涉及文件的位置都将在这个文件中寻找。</p>
<p>我们首先来看一下 <code>src/App.jsx</code> ，这是项目的主要页面，我们可以利用代码编辑器查看这个文件的主要部分：</p>
<p><img src="https://user-images.githubusercontent.com/3297411/153822564-f2f96aa8-1336-475b-adc8-cc251405cdff.png" alt="Appjsx"></p>
<p>其中包含的功能和组件包括：</p>
<ul>
<li><code>Header</code>：标题栏，显示标题</li>
<li><em><code>NetworkDisplay</code>：所处网络状态</em></li>
<li><em><code>Menu</code>， <code>Switch</code>：菜单切换</em></li>
<li><em><code>ThemeSwitch</code>：右下角明暗主题切换</em></li>
<li><em><code>Account</code>：右上角账户信息组件</em></li>
<li>接下来的两个 <code>Row</code> 对应左下角的 Gas 显示、支持和本地的水龙头</li>
</ul>
<p>下面我们主要看一下 <em><code>NetworkDisplay</code>和 <code>Account</code> 的逻辑实现，以及 <code>Menu</code>， <code>Switch</code> 中的功能。</em></p>
<h3><span id="networkdisplay"><em><code>NetworkDisplay</code></em></span></h3>
<p>组件位置： <code>src/components/NetworkDisplay.jsx</code></p>
<p>主要包含两个功能：</p>
<ol>
<li>显示当前所选择的网络名称；</li>
<li>如果当前钱包所在网络与项目中网络设置不一致，则提示警告，其中，当选择本地网络是，网络 ID 需要设置为 <code>31337</code> 。</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NetworkDisplay</span>(<span class="params">&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">  NETWORKCHECK,</span></span></span><br><span class="line"><span class="function"><span class="params">  localChainId,</span></span></span><br><span class="line"><span class="function"><span class="params">  selectedChainId,</span></span></span><br><span class="line"><span class="function"><span class="params">  targetNetwork,</span></span></span><br><span class="line"><span class="function"><span class="params">  USE_NETWORK_SELECTOR,</span></span></span><br><span class="line"><span class="function"><span class="params">  logoutOfWeb3Modal,</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> networkDisplay = <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">if</span> (NETWORKCHECK &amp;&amp; localChainId &amp;&amp; selectedChainId &amp;&amp; localChainId !== selectedChainId) &#123;</span><br><span class="line">    <span class="keyword">const</span> networkSelected = NETWORK(selectedChainId);</span><br><span class="line">    <span class="keyword">const</span> networkLocal = NETWORK(localChainId);</span><br><span class="line">    <span class="keyword">if</span> (selectedChainId === <span class="number">1337</span> &amp;&amp; localChainId === <span class="number">31337</span>) &#123;</span><br><span class="line">			<span class="comment">// 提示错误的网络ID</span></span><br><span class="line">			...</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">// 提示网络错误</span></span><br><span class="line">			...</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    networkDisplay = USE_NETWORK_SELECTOR ? <span class="literal">null</span> : (</span><br><span class="line">      <span class="comment">// 显示网络名称</span></span><br><span class="line">      &lt;div style=&#123;&#123; <span class="attr">zIndex</span>: <span class="number">-1</span>, <span class="attr">position</span>: <span class="string">"absolute"</span>, <span class="attr">right</span>: <span class="number">154</span>, <span class="attr">top</span>: <span class="number">28</span>, <span class="attr">padding</span>: <span class="number">16</span>, <span class="attr">color</span>: targetNetwork.color &#125;&#125;&gt;</span><br><span class="line">        &#123;targetNetwork.name&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  console.log(&#123; networkDisplay &#125;);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  return networkDisplay;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3><span id="account"><em><code>Account</code></em></span></h3>
<p>组件位置： <code>src/components/Account.jsx</code></p>
<p>主要包含两个功能：</p>
<ol>
<li>显示当前钱包</li>
<li>显示钱包余额</li>
<li>显示 <code>Connect</code> 或者 <code>Logout</code></li>
</ol>
<p>其中，当用户点击 <code>Connect</code> 时，前端调用 <em><code>loadWeb3Modal</code>，代码如下，这个函数的需要功能是与MetaMask等钱包进行连接，并监听钱包的</em>  <code>chainChanged</code>，<code>accountsChanged</code> 和 <code>disconnect</code> 事件，即当我们在钱包中切换网络，选择连接账户以及取消连接时对应修改显示状态。</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> loadWeb3Modal = useCallback(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line"><span class="comment">// 连接钱包</span></span><br><span class="line">  <span class="keyword">const</span> provider = <span class="keyword">await</span> web3Modal.connect();</span><br><span class="line">  setInjectedProvider(<span class="keyword">new</span> ethers.providers.Web3Provider(provider));</span><br><span class="line"><span class="comment">// 监听切换网络</span></span><br><span class="line">  provider.on(<span class="string">"chainChanged"</span>, chainId =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`chain changed to <span class="subst">$&#123;chainId&#125;</span>! updating providers`</span>);</span><br><span class="line">    setInjectedProvider(<span class="keyword">new</span> ethers.providers.Web3Provider(provider));</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 监听切换账户</span></span><br><span class="line">  provider.on(<span class="string">"accountsChanged"</span>, () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`account changed!`</span>);</span><br><span class="line">    setInjectedProvider(<span class="keyword">new</span> ethers.providers.Web3Provider(provider));</span><br><span class="line">  &#125;);</span><br><span class="line"><span class="comment">// 监听断开连接</span></span><br><span class="line">  <span class="comment">// Subscribe to session disconnection</span></span><br><span class="line">  provider.on(<span class="string">"disconnect"</span>, (code, reason) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(code, reason);</span><br><span class="line">    logoutOfWeb3Modal();</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// eslint-disable-next-line</span></span><br><span class="line">&#125;, [setInjectedProvider]);</span><br></pre></td></tr></table></figure>
<p>同理，在连接钱包情况下，用户点击 <code>Logout</code> 会调用 <code>logoutOfWeb3Modal</code> 功能，</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> logoutOfWeb3Modal = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">		<span class="comment">// 清楚缓存的网络提供商，并断开连接</span></span><br><span class="line">    <span class="keyword">await</span> web3Modal.clearCachedProvider();</span><br><span class="line">    <span class="keyword">if</span> (injectedProvider &amp;&amp; injectedProvider.provider &amp;&amp; <span class="keyword">typeof</span> injectedProvider.provider.disconnect == <span class="string">"function"</span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> injectedProvider.provider.disconnect();</span><br><span class="line">    &#125;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">window</span>.location.reload();</span><br><span class="line">    &#125;, <span class="number">1</span>);</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>
<h3><span id="menu-switch"><em><code>Menu</code>， <code>Switch</code></em></span></h3>
<p>这两个分别对应显示菜单和对应切换菜单功能，这些菜单包括：</p>
<ul>
<li><code>App Home</code> ：项目希望我们将需要实现的功能放在这个菜单中，比如我们将要实现的 NFT 的铸造和展示功能；</li>
<li><code>Debug Contracts</code>：调试自己编写的合约功能，将会根据合约的 ABI 文件 展示可以合约的状态变量和可以调用的函数；</li>
<li><code>Hints</code>：编程提示</li>
<li><code>ExampleUI</code>：示例UI，可以做为编程使用</li>
<li><code>Mainnet DAI</code>：以太坊主网 <code>DAI</code> 的合约状态和可用函数，与 <code>Debug Contracts</code> 功能一直</li>
<li><code>Subgraph</code>：使用 The Graph 协议对合约中的事件进行监听和查询。</li>
</ul>
<h3><span id="diao-shi-xin-xi">调试信息</span></h3>
<p><code>App.jsx</code> 中还包含了打印当前页面状态的调试信息，可以在开发的过程中实时查看当前状态变量。</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// 🧫 DEBUG 👨🏻‍🔬</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    DEBUG &amp;&amp;</span><br><span class="line">    mainnetProvider &amp;&amp;</span><br><span class="line">    address &amp;&amp;</span><br><span class="line">    selectedChainId &amp;&amp;</span><br><span class="line">    yourLocalBalance &amp;&amp;</span><br><span class="line">    yourMainnetBalance &amp;&amp;</span><br><span class="line">    readContracts &amp;&amp;</span><br><span class="line">    writeContracts &amp;&amp;</span><br><span class="line">    mainnetContracts</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"_____________________________________ 🏗 scaffold-eth _____________________________________"</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"🌎 mainnetProvider"</span>, mainnetProvider);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"🏠 localChainId"</span>, localChainId);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"👩‍💼 selected address:"</span>, address);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"🕵🏻‍♂️ selectedChainId:"</span>, selectedChainId);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"💵 yourLocalBalance"</span>, yourLocalBalance ? ethers.utils.formatEther(yourLocalBalance) : <span class="string">"..."</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"💵 yourMainnetBalance"</span>, yourMainnetBalance ? ethers.utils.formatEther(yourMainnetBalance) : <span class="string">"..."</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"📝 readContracts"</span>, readContracts);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"🌍 DAI contract on mainnet:"</span>, mainnetContracts);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"💵 yourMainnetDAIBalance"</span>, myMainnetDAIBalance);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"🔐 writeContracts"</span>, writeContracts);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, [</span><br><span class="line">  mainnetProvider,</span><br><span class="line">  address,</span><br><span class="line">  selectedChainId,</span><br><span class="line">  yourLocalBalance,</span><br><span class="line">  yourMainnetBalance,</span><br><span class="line">  readContracts,</span><br><span class="line">  writeContracts,</span><br><span class="line">  mainnetContracts,</span><br><span class="line">  localChainId,</span><br><span class="line">  myMainnetDAIBalance,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>
<p>查看完主页的基本功能，下面我们开始实现 NFT 铸造和展示 NFT 列表这两个功能。</p>
<h2><span id="nft-gong-neng-shi-xian">NFT 功能实现</span></h2>
<p>我们将主要实现以下三个部分功能：</p>
<ul>
<li>铸造 NFT；</li>
<li>展示 NFT 列表；</li>
<li>展示 NFT 合约接口列表。</li>
</ul>
<h3><span id="zhu-zao-nft">铸造 NFT</span></h3>
<p>首先我们找到 <code>App Home</code> 对应使用的组件，从下面的代码中可以看到，对应使用 <code>Home</code> 组件，所在位置为 <code>src/views/Home.jsx</code> 。</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">&lt;Switch&gt;</span><br><span class="line">    &lt;Route exact path=<span class="string">"/"</span>&gt;</span><br><span class="line">      &#123;<span class="comment">/* pass in any web3 props to this Home component. For example, yourLocalBalance */</span>&#125;</span><br><span class="line">      &lt;Home yourLocalBalance=&#123;yourLocalBalance&#125; readContracts=&#123;readContracts&#125; /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Route&gt;</span></span><br><span class="line"><span class="regexp">....</span></span><br></pre></td></tr></table></figure>
<p>删除 <code>Home.jsx</code> 中内容，添加以下 Mint 按钮：</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Button, Card, List &#125; <span class="keyword">from</span> <span class="string">"antd"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Home</span>(<span class="params">&#123; </span></span></span><br><span class="line"><span class="function"><span class="params">  isSigner,</span></span></span><br><span class="line"><span class="function"><span class="params">  loadWeb3Modal,</span></span></span><br><span class="line"><span class="function"><span class="params">  tx,</span></span></span><br><span class="line"><span class="function"><span class="params">  writeContracts,</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;<span class="comment">/* Mint button */</span>&#125;</span><br><span class="line">      &lt;div style=&#123;&#123; <span class="attr">maxWidth</span>: <span class="number">820</span>, <span class="attr">margin</span>: <span class="string">"auto"</span>, <span class="attr">marginTop</span>: <span class="number">32</span>, <span class="attr">paddingBottom</span>: <span class="number">32</span> &#125;&#125;&gt;</span><br><span class="line">        &#123;isSigner?(</span><br><span class="line">          &lt;Button type=&#123;<span class="string">"primary"</span>&#125; onClick=&#123;()=&gt;&#123;</span><br><span class="line">            tx( writeContracts.YourCollectible.mintItem() )</span><br><span class="line">          &#125;&#125;&gt;MINT&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">        ):(</span></span><br><span class="line"><span class="regexp">          &lt;Button type=&#123;"primary"&#125; onClick=&#123;loadWeb3Modal&#125;&gt;CONNECT WALLET&lt;/</span>Button&gt;</span><br><span class="line">        )&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Home;</span><br></pre></td></tr></table></figure>
<p>同时将 <code>Switch</code> 中对应组件使用修改为：</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">&lt;Switch&gt;</span><br><span class="line">  &lt;Route exact path=<span class="string">"/"</span>&gt;</span><br><span class="line">    &#123;<span class="comment">/* pass in any web3 props to this Home component. For example, yourLocalBalance */</span>&#125;</span><br><span class="line">    &lt;Home</span><br><span class="line">      isSigner=&#123;userSigner&#125;</span><br><span class="line">      loadWeb3Modal=&#123;loadWeb3Modal&#125;</span><br><span class="line">      tx=&#123;tx&#125;</span><br><span class="line">      writeContracts=&#123;writeContracts&#125;</span><br><span class="line">    /&gt;</span><br><span class="line"> ...</span><br></pre></td></tr></table></figure>
<p>效果图为：</p>
<p><img src="https://user-images.githubusercontent.com/3297411/153822638-2ce70ded-289b-411e-9ed5-c78507617427.png" alt="mint-button"></p>
<p>点击 Mint 之后，我们可以看到交易成功发出，这时，虽然我们成功 mint 了 NFT，但是我们还需要添加列表来展示我们的 NFT。</p>
<h3><span id="zhan-shi-nft-lie-biao">展示 NFT 列表</span></h3>
<p>添加列表展示，其中包含 NFT 的转移功能可以将对应的 NFT 发送给其他地址。</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Button, Card, List &#125; <span class="keyword">from</span> <span class="string">"antd"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useContractReader &#125; <span class="keyword">from</span> <span class="string">"eth-hooks"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Address, AddressInput&#125; <span class="keyword">from</span> <span class="string">"../components"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Home</span>(<span class="params">&#123; </span></span></span><br><span class="line"><span class="function"><span class="params">  isSigner,</span></span></span><br><span class="line"><span class="function"><span class="params">  loadWeb3Modal,</span></span></span><br><span class="line"><span class="function"><span class="params">  yourCollectibles,</span></span></span><br><span class="line"><span class="function"><span class="params">  address,</span></span></span><br><span class="line"><span class="function"><span class="params">  blockExplorer,</span></span></span><br><span class="line"><span class="function"><span class="params">  mainnetProvider,</span></span></span><br><span class="line"><span class="function"><span class="params">  tx,</span></span></span><br><span class="line"><span class="function"><span class="params">  readContracts,</span></span></span><br><span class="line"><span class="function"><span class="params">  writeContracts,</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [transferToAddresses, setTransferToAddresses] = useState(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;<span class="comment">/* Mint 按钮 */</span>&#125;</span><br><span class="line">			...</span><br><span class="line">			&#123;<span class="comment">/* 列表 */</span>&#125;</span><br><span class="line">      &lt;div style=&#123;&#123; <span class="attr">width</span>: <span class="number">820</span>, <span class="attr">margin</span>: <span class="string">"auto"</span>, <span class="attr">paddingBottom</span>: <span class="number">256</span> &#125;&#125;&gt;</span><br><span class="line">        &lt;List</span><br><span class="line">          bordered</span><br><span class="line">          dataSource=&#123;yourCollectibles&#125;</span><br><span class="line">          renderItem=&#123;item =&gt; &#123;</span><br><span class="line">            <span class="keyword">const</span> id = item.id.toNumber();</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"IMAGE"</span>,item.image)</span><br><span class="line">            <span class="keyword">return</span> (</span><br><span class="line">              &lt;List.Item key=&#123;id + <span class="string">"_"</span> + item.uri + <span class="string">"_"</span> + item.owner&#125;&gt;</span><br><span class="line">                &lt;Card</span><br><span class="line">                  title=&#123;</span><br><span class="line">                    &lt;div&gt;</span><br><span class="line">                      &lt;span style=&#123;&#123; <span class="attr">fontSize</span>: <span class="number">18</span>, <span class="attr">marginRight</span>: <span class="number">8</span> &#125;&#125;&gt;&#123;item.name&#125;&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">                    &lt;/</span>div&gt;</span><br><span class="line">                  &#125;</span><br><span class="line">                &gt;</span><br><span class="line">                  &lt;a href=&#123;<span class="string">"https://opensea.io/assets/"</span>+(readContracts &amp;&amp; readContracts.YourCollectible &amp;&amp; readContracts.YourCollectible.address)+<span class="string">"/"</span>+item.id&#125; target=<span class="string">"_blank"</span>&gt;</span><br><span class="line">                  &lt;img src=&#123;item.image&#125; /&gt;</span><br><span class="line">                  &lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">                  &lt;div&gt;&#123;item.description&#125;&lt;/</span>div&gt;</span><br><span class="line">                &lt;<span class="regexp">/Card&gt;</span></span><br><span class="line"><span class="regexp">								&#123;/</span>* NFT 转移 *<span class="regexp">/&#125;</span></span><br><span class="line"><span class="regexp">                &lt;div&gt;</span></span><br><span class="line"><span class="regexp">                  owner:&#123;" "&#125;</span></span><br><span class="line"><span class="regexp">                  &lt;Address</span></span><br><span class="line"><span class="regexp">                    address=&#123;item.owner&#125;</span></span><br><span class="line"><span class="regexp">                    ensProvider=&#123;mainnetProvider&#125;</span></span><br><span class="line"><span class="regexp">                    blockExplorer=&#123;blockExplorer&#125;</span></span><br><span class="line"><span class="regexp">                    fontSize=&#123;16&#125;</span></span><br><span class="line"><span class="regexp">                  /</span>&gt;</span><br><span class="line">                  &lt;AddressInput</span><br><span class="line">                    ensProvider=&#123;mainnetProvider&#125;</span><br><span class="line">                    placeholder=<span class="string">"transfer to address"</span></span><br><span class="line">                    value=&#123;transferToAddresses[id]&#125;</span><br><span class="line">                    onChange=&#123;newValue =&gt; &#123;</span><br><span class="line">                      <span class="keyword">const</span> update = &#123;&#125;;</span><br><span class="line">                      update[id] = newValue;</span><br><span class="line">                      setTransferToAddresses(&#123; ...transferToAddresses, ...update &#125;);</span><br><span class="line">                    &#125;&#125;</span><br><span class="line">                  /&gt;</span><br><span class="line">                  &lt;Button</span><br><span class="line">                    onClick=&#123;() =&gt; &#123;</span><br><span class="line">                      <span class="built_in">console</span>.log(<span class="string">"writeContracts"</span>, writeContracts);</span><br><span class="line">                      tx(writeContracts.YourCollectible.transferFrom(address, transferToAddresses[id], id));</span><br><span class="line">                    &#125;&#125;</span><br><span class="line">                  &gt;</span><br><span class="line">                    Transfer</span><br><span class="line">                  &lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">                &lt;/</span>div&gt;</span><br><span class="line">              &lt;<span class="regexp">/List.Item&gt;</span></span><br><span class="line"><span class="regexp">            );</span></span><br><span class="line"><span class="regexp">          &#125;&#125;</span></span><br><span class="line"><span class="regexp">        /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &#123;/</span>* 信息提示 *<span class="regexp">/&#125;</span></span><br><span class="line"><span class="regexp">      &lt;div style=&#123;&#123; maxWidth: 820, margin: "auto", marginTop: 32, paddingBottom: 256 &#125;&#125;&gt;</span></span><br><span class="line"><span class="regexp">        🛠 built with &lt;a href="https:/</span><span class="regexp">/github.com/</span>austintgriffith/scaffold-eth<span class="string">" target="</span>_blank<span class="string">"&gt;🏗 scaffold-eth&lt;/a&gt;</span></span><br><span class="line"><span class="string">        🍴 &lt;a href="</span>https:<span class="comment">//github.com/austintgriffith/scaffold-eth" target="_blank"&gt;Fork this repo&lt;/a&gt; and build a cool SVG NFT!</span></span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Home;</span><br></pre></td></tr></table></figure>
<p>对应组件使用修改为：</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">&lt;Switch&gt;</span><br><span class="line">  &lt;Route exact path=<span class="string">"/"</span>&gt;</span><br><span class="line">    &#123;<span class="comment">/* pass in any web3 props to this Home component. For example, yourLocalBalance */</span>&#125;</span><br><span class="line">    &lt;Home</span><br><span class="line">      isSigner=&#123;userSigner&#125;</span><br><span class="line">      loadWeb3Modal=&#123;loadWeb3Modal&#125;</span><br><span class="line">      yourCollectibles=&#123;yourCollectibles&#125;</span><br><span class="line">      address=&#123;address&#125;</span><br><span class="line">      blockExplorer=&#123;blockExplorer&#125;</span><br><span class="line">      mainnetProvider=&#123;mainnetProvider&#125;</span><br><span class="line">      tx=&#123;tx&#125;</span><br><span class="line">      writeContracts=&#123;writeContracts&#125;</span><br><span class="line">      readContracts=&#123;readContracts&#125;</span><br><span class="line">    /&gt;</span><br><span class="line"> ...</span><br></pre></td></tr></table></figure>
<p>效果图为：</p>
<p><img src="https://user-images.githubusercontent.com/3297411/153822686-e7f7c3c7-65ee-4b1c-ade2-204c6365177f.png" alt="nft-display-list"></p>
<p>但是我们发现，当我们再次 mint 时，列表并不会更新，还是原来的样子，因此我们需要在 <code>App.jsx</code> 中添加事件监听，一旦我们铸造 NFT 之后，列表将刷新：</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 跟踪当前 NFT 数量</span></span><br><span class="line"><span class="keyword">const</span> balance = useContractReader(readContracts, <span class="string">"YourCollectible"</span>, <span class="string">"balanceOf"</span>, [address]);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"🤗 balance:"</span>, balance);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> yourBalance = balance &amp;&amp; balance.toNumber &amp;&amp; balance.toNumber();</span><br><span class="line"><span class="keyword">const</span> [yourCollectibles, setYourCollectibles] = useState();</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// 🧠 这个 effect 会在 balance 变化时更新 yourCollectibles </span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> updateYourCollectibles = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> collectibleUpdate = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> tokenIndex = <span class="number">0</span>; tokenIndex &lt; balance; tokenIndex++) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"GEtting token index"</span>, tokenIndex);</span><br><span class="line">        <span class="keyword">const</span> tokenId = <span class="keyword">await</span> readContracts.YourCollectible.tokenOfOwnerByIndex(address, tokenIndex);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"tokenId"</span>, tokenId);</span><br><span class="line">        <span class="keyword">const</span> tokenURI = <span class="keyword">await</span> readContracts.YourCollectible.tokenURI(tokenId);</span><br><span class="line">        <span class="keyword">const</span> jsonManifestString = atob(tokenURI.substring(<span class="number">29</span>))</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"jsonManifestString"</span>, jsonManifestString);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> jsonManifest = <span class="built_in">JSON</span>.parse(jsonManifestString);</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">"jsonManifest"</span>, jsonManifest);</span><br><span class="line">          collectibleUpdate.push(&#123; <span class="attr">id</span>: tokenId, <span class="attr">uri</span>: tokenURI, <span class="attr">owner</span>: address, ...jsonManifest &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    setYourCollectibles(collectibleUpdate.reverse());</span><br><span class="line">  &#125;;</span><br><span class="line">  updateYourCollectibles();</span><br><span class="line">&#125;, [address, yourBalance]);</span><br></pre></td></tr></table></figure>
<p>此时，当我们再次 Mint 时，就是自动更新列表，显示最新铸造的 NFT 了。</p>
<h3><span id="zhan-shi-nft-he-yue-jie-kou-lie-biao">展示 NFT 合约接口列表</span></h3>
<p>这个功能比较简单，只需要修改对应 debug 部分即可：</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;Route exact path=<span class="string">"/debug"</span>&gt;</span><br><span class="line">    &#123;<span class="comment">/*</span></span><br><span class="line"><span class="comment">          🎛 this scaffolding is full of commonly used components</span></span><br><span class="line"><span class="comment">          this &lt;Contract/&gt; component will automatically parse your ABI</span></span><br><span class="line"><span class="comment">          and give you a form to interact with it locally</span></span><br><span class="line"><span class="comment">      */</span>&#125;</span><br><span class="line"></span><br><span class="line">    &lt;Contract</span><br><span class="line">      name=<span class="string">"YourCollectible"</span></span><br><span class="line">      price=&#123;price&#125;</span><br><span class="line">      signer=&#123;userSigner&#125;</span><br><span class="line">      provider=&#123;localProvider&#125;</span><br><span class="line">      address=&#123;address&#125;</span><br><span class="line">      blockExplorer=&#123;blockExplorer&#125;</span><br><span class="line">      contractConfig=&#123;contractConfig&#125;</span><br><span class="line">    /&gt;</span><br></pre></td></tr></table></figure>
<p>更新之后，可以在 <code>Debug Contracts</code> 菜单下看到合约的可以调用的函数。</p>
<p><img src="https://user-images.githubusercontent.com/3297411/153822741-30c8d3c6-077b-49b9-8b88-bc62119215cf.png" alt="contract-funcs"></p>
<p>至此，我们就完成了一个简单 NFT 铸造和展示的 DApp 了。</p>
<h2><span id="zong-jie">总结</span></h2>
<p>通过这个项目，我们可以学习并了解以下知识：</p>
<ol>
<li>NFT 合约基本内容以及如何在 Opensea 等市场中展示 NFT；</li>
<li>前端如何连接诸如 MetaMask 等钱包；</li>
<li>前端如何调用合约函数。</li>
</ol>
<h3><span id="comments">Comments</span></h3>
</div><p class="post-tags"><i class="fa fa-tags" aria-hidden="true"></i><a href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/">#区块链</a></p></article></div><div class="post-copyright"><blockquote><p>版权声明：本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener">署名-相同方式共享 | CC BY-SA 4.0 </a>许可协议。</p></blockquote></div><footer><div class="paginator"><a href="/qiwihui-blog-147/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'blog-qiwihui-com';
var disqus_identifier = 'qiwihui-blog-153/';
var disqus_title = 'SVG NFT 全面实践 ── scaffold-eth loogies-svg-nft 项目完整指南';
var disqus_url = 'https://qiwihui.com/qiwihui-blog-153/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//blog-qiwihui-com.disqus.com/count.js" async></script><!-- block copyright--></footer></div><script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true,
        processEnvironments: true,
        skipTags: ["script","noscript","style","textarea","code","pre"]
    }
});
</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-46660488-3",'auto');ga('send','pageview');</script><link rel="stylesheet" href="//cdn.datatables.net/1.10.7/css/jquery.dataTables.min.css" media="screen" type="text/css"><script src="//cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js"></script><script>$(function(){$('.datatable').dataTable( {"order": [[ 0, "desc" ]],"iDisplayLength": -1,"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]]} );});</script></body></html>