# Sui 公链研究整理


官网：[https://sui.io/](https://sui.io/)

白皮书：[https://github.com/MystenLabs/sui/blob/main/doc/paper/sui.pdf](https://github.com/MystenLabs/sui/blob/main/doc/paper/sui.pdf)

<!--more-->

## 技术

水平可扩展性，高吞吐，低延迟。

技术特征：

1. 变体 Move 语言
    1. 安全特性（内存安全，Move Prover）
    2. 编程范式：虽然大多数区块链的存储都以帐户为中心，但 Sui 的存储是围绕对象设计的。每个对象由一个地址所拥有，默认情况下可变，也可设为不可变或在多个地址之间共享。Sui 的 Move 智能合约可以接收这些对象作为输入，对其进行操作，并将对象作为输出返回。这是一种完全不同于 Solidity 或 Rust 的智能合约编程范式，更具表现力，对于动态NFT和加密游戏的数字对象表达更简单。
    3. 改善网络性能并简化开发人员体验
    4. 相较于Solidity，较少经历项目验证，缺少安全实践。
2. 交易并行化
    1. 对于链上的大多数交易都不会与其他交易竞争相同的资源(例如对同一个NFT发起两笔交易)，按目前公链的设计（例如ETH），需要对一个总的排序交易列表来进行全节点的共识确认，因此造成了大量的计算浪费。
    2. Sui不要求全序，只要满足因果关系的交易顺序执行即可，没有因果关系的交易可以被Sui的验证器以任意顺序执行。
3. 可扩展性
    1. 因为不要求交易满足全序，只要求交易满足因果顺序。
    2. 使用 Narwhal 共识机制来全排序包含共享对象的交易
    3. 水平扩展，多机器分片，可以通过给验证节点增加设备来提升吞吐
4. 共识机制
    - 拜占庭式一致广播，用于独立的交易
    - BFT 共识（+基于 DAG 的 mempool），用于有依赖关系的交易（共享对象）
    - 共识算法专注于尽量减少验证节点之间处理交易所需的通信。

## Token 经济学

### 概况

代币经济白皮书：[The Sui Smart Contracts Platform: Economics and Incentives](https://github.com/MystenLabs/sui/blob/main/doc/paper/tokenomics.pdf)

代币：SUI

总供应量： 100亿，分配给创始团队、投资者、公售、Sui 基金会和未来的释放。

代币作用：

- 质押/保护网络
- 交易费
- 治理
- 账户单位/交易中介

角色：

- 用户：使用 Sui 平台进行交易，以创建，修改和转移数字资产或与基于智能合约，互操作性，可组合性的复杂应用进行交互；
- SUI代币持有者：可选择将其代币委托给验证者并参与权益证明机制（POS）。SUI 所有者也拥有参与 Sui 治理的权利
- 验证者：进行 Sui 公链上的事务处理和执行

五个核心组件：

- SUI 代币是 Sui 平台的原生资产。
- 所有网络操作都收取 Gas 费，用于奖励权益证明机制的参与者，防止垃圾信息和拒绝服务攻击。
- Sui 的存储基金用于跨时间转移权益奖励，并补偿未来验证者先前存储的链上数据的存储成本。
- 权益证明机制 PoS 用于选择、激励和奖励 Sui 平台操作者（即验证者和 SUI 委托人）的诚实行为。
- 链上投票用于治理和协议升级。

![sui-token-economics](https://user-images.githubusercontent.com/3297411/181870355-c7269c0d-7969-4ea9-a3c3-9610c2238a63.png)

### Gas定价模型

为用户提供**可预测**的**低的**交易费用、激励验证者优化其交易处理操作以及防止拒绝服务攻击。

Gas 费用包含两个部分：计算执行费用和存储费用，并为两部分费用分别计价。

计算价格定价机制：

- Sui 以纪元为单位运行，每个纪元（24 小时）验证节点集都会改变。新纪元的验证节点会就整个纪元的参考 Gas 费进行投票。该协议会提供一些激励措施，鼓励验证节点在整个纪元将交易费用保持在接近参考价格的水平。具体过程为：
    1. 在每个纪元开始时，需要每个验证者提交一个 gas 报价（即每个验证者愿意处理交易的最低gas价格)，Sui将会把总gas报价列表中2/3位置处的价格设置为这个纪元的参考gas价格，例如总共有 100 个验证者者提供了 gas 报价，将所有的 gas 报价进行低到高排序，其中第 67 位验证者提供的 gas 报价即为本纪元的参考 gas 价格
    2. 在用户提交交易时，可按参考 gas 价格进行 gas 价格设置，但由于每个用户习惯不一致和链上网络的波动情况，因此最终实际的 gas 价格会与参考 gas 价格有一点的出入。
    3. 在每个纪元结束时，会根据每个验证者执行的实际 gas 价格情况进行奖励的分配，在纪元开始时提交低价报价（即低于参考价格）或处理实际 gas 价格高于其 gas 报价交易的验证者会获得更高的奖励。相反，在纪元开始时提交高价报价（即高于参考价格）或处理实际 gas 价格低于其 gas 报价的验证者将受到奖励减少的惩罚。
- 通过这套机制，一是鼓励验证者降低其 gas 价格的报价，二是让用户有一个参考价格供其参考，保证用户设置接近参考价格的 gas 的交易能够得到及时的处理。

存储价格：

- 通过治理提案设置，并不经常更新。目的是通过将这些费用存入存储基金，然后将这些费用重新分配给未来的验证者，确保 Sui 用户为其使用链上数据存储付费。 与计算 gas 价格相比，存储价格是固定的，并且对于一个纪元内和跨纪元的所有交易都是通用的，直到存储价格更新。

网络堵塞期间 Gas 费如何保持在低位：因为网络的吞吐量与更多的参与者成线性关系，验证节点可以根据网络需求的增加按比例增加更多的参与者，以此使 Gas 价格接近参考价格。

存储基金：

- 解决状态通胀（state bloat）问题
- Sui 的一个关键特性是它能够处理任意数量的链上数据，但却需要足够多的存储资源来进行支持。因此用户在进行每笔交易时，在当下即支付了一笔存储费用到存储基金，存储基金将会使用这笔资金来奖励未来的验证者，因为未来的验证者也为当下用户数据的存储付出了成本（即验证者需要存储全账本）。当链上存储要求很高时，验证者会获得大量额外奖励以补偿其成本。当存储要求较低时，反之亦然。
- 从长远来看，随着技术改进导致存储成本下降和 SUI 代币价格的变化，治理提案将更新存储 gas 价格以反映其新的目标价格。
- Sui 的存储模型包括一个“删除选项”，用户在删除之前存储的链上数据（例如 NFT 的元数据）时，可以通过该选项获得存储费回扣（即从之前支付的存储 gas 中返回一笔资金，因为自己的数据无需再进行存储）。

### PoS 委托模型

SUI 持有者可以将自己的 SUI 委托给给验证者进行质押，在每个纪元结束时可获取对应份额的奖励。

验证者在总质押奖励中的份额是与质押数量相关的，因为它决定了每个验证者在处理交易中的投票权份额。每笔Sui的交易只需要2/3的验证者按权益份额进行处理，因此拥有质押数量越多的验证者将拥有更多的份额，从而处理更多的交易，获取到更多的奖励。同时在计算总奖励时，Sui 也会对存储基金进行分配，因此验证者就会相对于 SUI 委托人获得更多的质押奖励。

同时在每个纪元开始前，SUI 持有者可自由地选择验证者进行 SUI 的质押，因此对于处理速度快的验证者将处理更多的交易，获取到更多的执行 gas 奖励，持有者也更愿意选择这种验证者进行质押，从而提升了整个 Sui 网络验证者的质量。

## 团队情况

### 概况

- 开发团队：Mysten Labs
- 创始人包括 [Evan Cheng](https://twitter.com/EvanWeb3)、[Adeniyi Abiodun](https://twitter.com/EmanAbio)、[Sam Blackshear](https://twitter.com/b1ackd0g)、[George Danezis](https://twitter.com/GDanezis)、[Kostas Kryptos](https://twitter.com/kostascrypto)，均在 Meta 参与过 Novi 和 Diem 项目

### 融资

- Mysten Labs 于 2021 年 12 月宣布完成 3600 万美元 A 轮融资，该轮融资由 a16z 领投，Coinbase Ventures、NFX、Slow Ventures、Scribble Ventures、Samsung NEXT、Lux Capital 等参投。
- 正在寻求以 20 亿美元估值筹集至少 2 亿美元 B 轮融资，本轮融资由 FTX Ventures 领投，目前项目方已在该轮融资中获得 1.4 亿美元资金支持。

## 生态建设

1. 团队构想的公链 4 个关键应用：游戏、DeFi、商业和社交。所有 4 个应用都将充分利用 Sui 的高吞吐量和低延迟来提供最佳用户体验。游戏和社交应用在 Sui 上构建还具有独特的优势。游戏可以利用 Move 针对数字形象的安全性和表现力。社交媒体应用可以利用 Sui 的数据存储经济学将所有数据直接存储在链上。
2. Sui Monstars，游戏。

## 风险点

1. 公链生态的构建是一个漫长的过程。
2. 掌握全网质押总量的2/3即可控制整个网络,若是有验证者和Web2大公司一样发起质押补贴，例如将本属于自己的执行 gas 和存储 gas 也发放给将 SUI 质押在自己这里的 SUI 持有者，则会吸引大量的 SUI 持有者将自己的 SUI 质押在这样的验证者节点上，从而让这个验证者掌握了整个网络的控制权，从而具备了作恶的能力。一旦开始作恶，则可能使整个网络的其他参与者的利益受损。
3. Move 语言做为新兴合约语言，在学习成本，安全/审计，开发工具完备成都，成熟的合约组件等，都与Solidity有一定的距离。

## 参考

1. [新公链Sui：估值20亿美元的前Facebook团队打造的Layer1](https://www.theblockbeats.info/news/31206)
2. [Linda_郑郑的thread](https://twitter.com/linda_guagua/status/1549031224555237378?s=20&t=d6yTDgKMK6KJNaR2qkoKVA)
3. [Sui---前facebook团队和顶级机构创建的新一代区块链公链【Vic TALK 第263期】](https://www.youtube.com/watch?v=bTiyATYCU20)
4. [https://cryptohot.substack.com/p/-sui-](https://cryptohot.substack.com/p/-sui-)
5. [https://twitter.com/mindaoyang/status/1552384026383904768](https://twitter.com/mindaoyang/status/1552384026383904768)
6. [https://twitter.com/tracecrypto1/status/1544332560389607424](https://twitter.com/tracecrypto1/status/1544332560389607424)
7. [https://twitter.com/cryptoalvatar/status/1551878534926401537](https://twitter.com/cryptoalvatar/status/1551878534926401537)
8. [https://twitter.com/state_xyz/status/1551878856151142401](https://twitter.com/state_xyz/status/1551878856151142401)

[View on GitHub](https://github.com/qiwihui/blog/issues/162)


